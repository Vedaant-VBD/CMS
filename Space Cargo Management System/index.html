<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cargo Management System UI</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <h1>Cargo Management System</h1>

  <div class="section">
    <h2>1. Import Containers</h2>
    <div class="flex">
      <input type="file" id="containerCSV">
      <button onclick="uploadCSV('containers')">Upload Containers</button>
    </div>
  </div>

  <div class="section">
    <h2>2. Import Items</h2>
    <div class="flex">
      <input type="file" id="itemCSV">
      <button onclick="uploadCSV('items')">Upload Items</button>
    </div>
  </div>

  <div class="section">
    <h2>3. Get Placement Recommendations</h2>
    <button onclick="placement()">Get Placement</button>
  </div>

  <div class="section">
    <h2>4. Search Item</h2>
    <div class="flex">
      <input type="text" id="searchItemId" placeholder="Enter Item ID">
      <button onclick="searchItem()">Search</button>
    </div>
  </div>

  <div class="section">
    <h2>5. Identify Waste</h2>
    <button onclick="identifyWaste()">Identify Waste</button>
  </div>

  <div class="section">
    <h2>6. Simulate Day</h2>
    <div class="flex">
      <input type="number" id="daysToSimulate" placeholder="Number of Days">
      <button onclick="simulateDay()">Simulate</button>
    </div>
  </div>

  <div class="section">
    <h2>7. View Logs</h2>
    <button onclick="getLogs()">Get Logs</button>
  </div>

  <div class="section">
    <h2>ðŸ“¦ API Response</h2>
    <pre id="response">Responses will appear here...</pre>
  </div>

  <script>
    const apiBase = "http://localhost:8000";

    function showResponse(data) {
      document.getElementById("response").textContent = JSON.stringify(data, null, 2);
    }

    async function uploadCSV(type) {
      const fileInput = document.getElementById(type === "items" ? "itemCSV" : "containerCSV");
      const file = fileInput.files[0];
      if (!file) return alert("Please select a file!");

      const formData = new FormData();
      formData.append("file", file);

      const endpoint = `${apiBase}/api/import/${type}`;
      const res = await fetch(endpoint, { method: "POST", body: formData });
      const data = await res.json();
      showResponse(data);
    }

    async function placement() {
      const res = await fetch(`${apiBase}/api/placement`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ items: [], containers: [] }) // Placeholder, backend logic needed
      });
      const data = await res.json();
      showResponse(data);
    }

    async function searchItem() {
      const itemId = document.getElementById("searchItemId").value;
      const res = await fetch(`${apiBase}/api/search?itemId=${itemId}`);
      const data = await res.json();
      showResponse(data);
    }

    async function identifyWaste() {
      const res = await fetch(`${apiBase}/api/waste/identify`);
      const data = await res.json();
      showResponse(data);
    }

    async function simulateDay() {
      const days = parseInt(document.getElementById("daysToSimulate").value || "1");
      const res = await fetch(`${apiBase}/api/simulate/day`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ numOfDays: days })
      });
      const data = await res.json();
      showResponse(data);
    }

    async function getLogs() {
      const res = await fetch(`${apiBase}/api/logs`);
      const data = await res.json();
      showResponse(data);
    }
  </script>

</body>
</html>
